## สัมมนาเชิงปฏิบัติการเรื่อง "ไอโอทีสำหรับระบบควบคุมและการเรียนรู้ของเครื่อง"
## "IoT for Control Systems and Machine Learning" Seminar & Workshop

<hr>
<p />  
  
![nuws24_header](https://github.com/dewdotninja/nuws24/assets/37393409/b0b329c4-789a-466b-9406-483445eeb6e3)

<img align=left src="https://i.imgur.com/CzEUVpd.jpg" width=250 /> 
<ul>
  <li /><b>ชื่อเรื่อง :</b> ไอโอทีสำหรับระบบควบคุมและการเรียนรู้ของเครื่อง 
  <li /><b>Topic :</b> IoT for Control Systems and Machine Learning   
  <li /><b>วิทยากร :</b> ดร.วโรดม ตู้จินดา <img align=right src="https://github.com/dewdotninja/nuws24/assets/37393409/90b6909b-3dc3-4212-82be-ac7d07ae1261" width=80 />
  <li /><b>สถานที่ :</b> ภาควิชาฟิสิกส์ คณะวิทยาศาสตร์ มหาวิทยาลัยนเรศวร
  <li /><b>วัน-เวลา :</b> เสาร์ 17 กุมภาพันธ์ 2567
</ul>
<hr>

ในปัจจุบันไอโอที (IoT: Internet of Things) เป็นนวัตกรรมที่ได้รับความนิยมเป็นอย่างมาก แม้ว่าไอโอทีจะมีอัตราการรับส่งข้อมูลต่ำ แต่มีข้อดีคือสามารถใช้ประโยชน์จากการแพร่กระจายของอินเทอร์เน็ตที่ครอบคลุมแทบทุกพื้นที่บนโลก ในประเทศไทยที่ประชากรจำนวนมากประกอบอาชีพด้านเกษตรกรรม ผู้พัฒนาไอโอทีส่วนใหญ่จึงมุ่งเน้นไปทางด้านอุปกรณ์ที่ช่วยอำนวยความสะดวกหรือเพิ่มผลผลิตทางการเกษตร ส่วนการประยุกต์ใช้งานอื่นก็เช่นการประหยัดพลังงานในอาคาร ระบบรักษาความปลอดภัยในบ้านเรือน สำหรับการใช้งานด้านอุตสาหรรมก็พบเห็นได้บ้างแต่ยังมีน้อยอยู่ ในขณะที่งานไอโอทีในต่างประเทศเกี่ยวข้องกับหุ่นยนต์ ยานยนต์ขับเคลื่อนอัตโนมัติ ซึ่งจะเห็นว่าเป็นโจทย์ที่ยากและท้าทาย

โดยหลักการแล้วไอโอทีเป็นเพียงการสื่อสารข้อมูลที่ช่วยให้สามารถควบคุมและแสดงผลผ่านอินเทอร์เน็ตได้เท่านั้น การใช้ประโยชน์ในงานที่มีความซับซ้อนมากขึ้นคือต้องอาศัยการพัฒนาโปรแกรมเพื่อให้อุปกรณ์มีความชาญฉลาด สามารถในการทำงานนั้นได้อย่างมีประสิทธิภาพ และเป็นมิตรกับผู้ใช้งาน ดังนั้นในรายวิชาที่ผู้สอนรับผิดชอบที่เกี่ยวข้องกับไอโอที จะเน้นการออกแบบระบบฝังตัวตั้งแต่ฮาร์ดแวร์คือตัวประมวลผล เซนเซอร์ วงจรเชื่อมต่อ การปรับแต่งสัญญาณ การกรองสัญญาณรบกวน จนถึงด้านซอฟต์แวร์ การอิมพลิเมนต์อัลกอริทึมที่ทำให้อุปกรณ์นั้นเป็นได้มากกว่าการแสดงผลและสั่งงานอย่างง่าย ตัวอย่างเช่น ตัวควบคุมป้อนกลับประเภทต่างๆ ตัวควบคุมแขนกล/หุ่นยนต์ วิเคราะห์สัญญาณโดย FFT 

ในกรณีที่ซอฟต์แวร์ที่สร้างความชาญฉลาดมีความซับซ้อนและต้องการทรัพยากรมากกว่าที่มีในระบบฝังตัว การใช้ไอโอทีร่วมกับการออกแบบชั้นของซอฟต์แวร์ที่เหมาะสมช่วยให้สามารถอิมพลิเมนต์ส่วนชั้นบนของซอฟต์แวร์ภายนอกระบบฝังตัวได้ ดังตัวอย่างการจำลองระบบแขนกลและหุ่นยนต์ในภาคบ่ายของสัมมนานี้

ในการสัมมนาเชิงปฏิบัติการครั้งนี้จะคัดเลือกบางส่วนที่สำคัญเพื่อความเหมาะสมกับช่วงเวลา 1 วัน โดยมุ่งเน้นที่ตัวควบคุมไอโอทีสำหรับงานควบคุมกระบวนการ และการควบคุมการเคลื่อนที่ ในช่วงท้ายจะเข้าสู่พื้นฐานของการเรียนรู้เสริมกำลัง (reinforcement learning) คือการอิมพลิเมนต์สมการเบลแมน (Bellman equattion) ช่วยแก้ปัญหาการวนซ้ำมูลค่า (value iteration) สำหรับวางแผนเส้นทางเดินหุ่นยนต์เคลื่อนที่ ซึ่งเป็นเนื้อหาใหม่ที่จะนำเสนอในสัมมนานี้เป็นครั้งแรก

<hr>

#### กำหนดการ

9 AM - 12 PM

<ul>
<li />ติดตั้งซอฟต์แวร์ สาธิตการใช้ Jupyter notebook และ Thonny
<li />วงจรเชื่อมต่อกับ MCU และการปรับแต่งสัญญาณ 
<li />พื้นฐานของระบบควบคุม (เน้นตัวควบคุม PID)
<li />การอิมพลิเมนต์ระบบควบคุมเชิงเส้น
<li />การจำลองระบบฝังตัวบน Wokwi
<li />การพัฒนาไอโอทีบน NETPIE 2020
<li />การแสดงผลและควบคุมบน NETPIE 2020 dashboard
<li />เขียนโปรแกรมไมโครไพทอนเพื่อควบคุมอัตราการไหลของถังน้ำ 3 ระดับ 
</ul>

1 - 4 PM

<ul>
<li />การใช้งาน paho-mqtt บน Jupyter notebook เพื่อนำข้อมูลจากระบบฝังตัวมาแสดงผลในรูปแบบที่ต้องการ
<li />การอิมพลิเมนต์ตัวควบคุมไม่เป็นเชิงเส้นสำหรับแขนกล 2 ก้านต่อ (2-link manipulator)
<li />การจำลองจลนศาสตร์หุ่นยนต์ (robot kinematics)
<li />ตัวควบคุมสำหรับหุ่นยนต์เคลื่อนที่ (mobile robot)
<li />การวางแผนเส้นทางเดินโดยอัลกอริทึมวนซ้ำมุูลค่า (value iteration)
<li />สรุปการสัมมนา
</ul>

<hr>

### อุปกรณ์ที่ใช้ในการอบรม

<ul>
  <li />เครื่องคอมพิวเตอร์ระบบปฏิบัติการ Windows, Mac-OSX หรือ Linux (ซอฟต์แวร์ที่ใช้สามารถใช้งานฟรีทั้งหมด)
  <li />สัญญาณ WiFi เพื่อเชื่อมต่ออินเทอร์เน็ต (อาจใช้การสร้าง hotspot จากมือถือของผู้เรียนได้)
</ul>

### เอกสารประกอบ

สไลด์และไฟล์โปรแกรมทั้งหมดรวบรวมไว้ใน Github repository นี้
<ul>
  <li /><a href="https://github.com/dewdotninja/nuws24/blob/main/slides/nuws24A.pdf">สไลด์สำหรับภาคเช้า</a>
  <li /><a href="https://github.com/dewdotninja/nuws24/blob/main/slides/nuws24B.pdf">สไลด์สำหรับภาคบ่าย</a>  
</ul>

### คลิปวีดีโอจากการสัมมนา

คลิปวีดีโอบางส่วนจากการสัมมนา โดยได้ตัดส่วนที่เป็นปัญหาออก เสียงจากวีดีโออาจไม่ชัดเจนในบางช่วง

<ul>
<li /><a href="https://youtu.be/4TmyNaMUU_E?si=5MqifoZwqmclGuPK">คลิป 1/4</a>
<li /><a href="https://youtu.be/qhON8qKHCUI?si=4PxIYuzaxCobPEGG">คลิป 2/4</a>
<li /><a href="https://youtu.be/5RudzxRPk_I?si=bHVDShHvyx1J_sOn">คลิป 3/4</a>
<li /><a href="https://youtu.be/DwMHgGO9GBs?si=Y-iPOIEbCafYILTk">คลิป 4/4</a>
</ul>

### คลิปวีดีโอเสริม

วีดีโอแนะนำการรันโค้ดจากหนังสือ และในส่วนของบทที่ 8 ที่ไม่สามารถรันได้ในช่วงสัมมนาเนื่องจากปัญหาของ paho-mqtt เวอร์ชัน 2.0.0 

<ul>
<li /><a href="https://youtu.be/cTvssFFuPXw?si=RJRW-TDf5veUgQKF" target=_blank>คลิปวีดีโอแนะนำหนังสือและโปรแกรม</a>
<li /><a href="https://youtu.be/P5REf6HBmz0?si=14ktX0IOTdaUbArB">ใช้ NETPIE IoT จำลองจลนศาสตร์แขนกลบน Jupyter notebook</a>
<li /><a href="https://youtu.be/Dfr7qgxvRS8?si=6LlR_nIbKrHQhWb5">ตัวควบคุมไอโอทีสำหรับหุ่นยนต์สองล้อ (differential drive robot)</a>
<li /><a href="https://youtu.be/3vH49engcdo?si=U-qlE9JvXggqxU1C">แก้ปัญหากริดเวิลด์เพื่อวางแผนเส้นทางเดินหุ่นยนต์</a>

</ul>

<hr>

### แก้ไข/เพิ่มเติม/อัพเดต

#### 20 กพ. 67

ปัญหาที่เกิดขึ้นในช่วงบ่ายคือ ไลบรารี paho-mqtt เวอร์ชันใหม่ที่ 2.0.0 ที่เริ่มใช้วันที่ 11 กพ. 67 มีการเปลี่ยนแปลงโค้ดสำหรับตั้งค่าเริ่มต้น client ทำให้โค้ดที่อยู่ใน notebook ตรงส่วนนี้

```python
Client_ID = ""
User = ""
Password = ""
client = mqtt.Client(client_id=Client_ID,
                         transport='tcp',
                         protocol=mqtt.MQTTv311,
                         clean_session=True)
client.username_pw_set(User,Password)
```
ไม่สามารถทำงานได้ ต้องมีการแก้ไขเป็นดังนี้

```python
Client_ID = ""
User = ""
Password = ""
client = mqtt.Client(mqtt.CallbackAPIVersion.VERSION2,
                         client_id=Client_ID,
                         transport='tcp',
                         protocol=mqtt.MQTTv311,
                         clean_session=True)
client.username_pw_set(User,Password)
```

จะเห็นว่ามีการเพิ่มอาร์กิวเมนต์แรกคือ mqtt.CallbackAPIVersion.VERSION2 ซึ่งจำเป็นต้องมี ดาวน์โหลดโค้ดที่แก้ไขแล้วได้จากลิงก์หนังสือด้านล่างโดยเลือกไดเรคทอรีย่อย /paho_v2/

<hr>


การสัมมนานี้สอดคล้องกับเนื้อหาในหนังสือ "การโปรแกรมไพทอนสำหรับงานควบคุมและฝังตัว" ที่สามารถดาวน์โหลดได้ฟรีทั้งเล่มจากลิงก์ด้านล่างนี้

https://github.com/dewdotninja/py4conemb 
